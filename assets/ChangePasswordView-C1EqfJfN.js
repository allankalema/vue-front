import{P as h}from"./ProfileLayout-BDE1aTYF.js";import{d as P,g}from"./authService-Aa4usrHm.js";import{_ as k,s as v,w as M,g as b,o as n,b as s,c as i,d as w,t as u,e as y,C as c,x as p,n as d,A as m}from"./index-kgVnbPEp.js";import"./Nita-logo-CbE_mBG5.js";const C={name:"ChangePasswordView",components:{ProfileLayout:h},data(){return{form:{oldPassword:"",newPassword:"",confirmPassword:""},errors:{},errorMessage:"",successMessage:"",isLoading:!1,showOldPassword:!1,showNewPassword:!1,showConfirmPassword:!1,username:""}},computed:{passwordHasMinLength(){return this.form.newPassword.length>=8},passwordHasNumber(){return/\d/.test(this.form.newPassword)},passwordIsDifferent(){return this.form.newPassword&&this.form.newPassword!==this.form.oldPassword},isFormValid(){return this.form.oldPassword&&this.form.newPassword&&this.form.confirmPassword&&this.passwordHasMinLength&&this.passwordHasNumber&&this.passwordIsDifferent}},mounted(){this.loadUserData()},methods:{loadUserData(){const e=g();e&&e.user?this.username=e.user.username:this.$router.push("/login")},clearError(e){this.errors[e]&&(this.errors[e]=""),this.errorMessage&&(this.errorMessage=""),this.successMessage&&(this.successMessage="")},validateForm(){this.errors={};let e=!0;return this.form.oldPassword||(this.errors.oldPassword="Current password is required",e=!1),this.form.newPassword?this.form.newPassword.length<8?(this.errors.newPassword="Password must be at least 8 characters",e=!1):/\d/.test(this.form.newPassword)?this.form.newPassword===this.form.oldPassword&&(this.errors.newPassword="New password must be different from current password",e=!1):(this.errors.newPassword="Password must contain at least one number",e=!1):(this.errors.newPassword="New password is required",e=!1),this.form.confirmPassword?this.form.newPassword!==this.form.confirmPassword&&(this.errors.confirmPassword="Passwords do not match",e=!1):(this.errors.confirmPassword="Please confirm your new password",e=!1),e},async handleSubmit(){if(this.validateForm()){this.errorMessage="",this.successMessage="",this.isLoading=!0;try{const e=await P(this.username,this.form.oldPassword,this.form.newPassword);this.successMessage=e.message||"Password changed successfully!",this.form={oldPassword:"",newPassword:"",confirmPassword:""},window.scrollTo({top:0,behavior:"smooth"})}catch(e){if(console.error("Password change error:",e),e.response){const r=e.response.status,a=e.response.data;r===400?a.detail&&a.detail.includes("incorrect")?(this.errors.oldPassword="Current password is incorrect",this.errorMessage="Current password is incorrect"):this.errorMessage=a.detail||a.message||"Please check the form for errors":r===403?this.errorMessage="You do not have permission to change this password":r>=500?this.errorMessage="Server error. Please try again later.":this.errorMessage=a.detail||a.message||"Failed to change password"}else e.request?this.errorMessage="Network error. Please check your internet connection.":this.errorMessage="An unexpected error occurred. Please try again.";window.scrollTo({top:0,behavior:"smooth"})}finally{this.isLoading=!1}}},handleCancel(){this.form={oldPassword:"",newPassword:"",confirmPassword:""},this.errors={},this.errorMessage="",this.successMessage=""}}},x={class:"change-password"},L={key:0,class:"success-alert"},B={class:"alert-content"},N={class:"alert-title"},j={key:1,class:"error-alert"},q={class:"error-text"},_={class:"form-group"},z={class:"password-wrapper"},V=["type","disabled"],A={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},D={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},H={key:0,class:"field-error"},U={class:"form-group"},E={class:"password-wrapper"},I=["type","disabled"],S={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},F={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},O={key:0,class:"field-error"},T={class:"password-requirements"},Y={class:"form-group"},G={class:"password-wrapper"},J=["type","disabled"],K={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Q={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},R={key:0,class:"field-error"},W={class:"form-actions"},X=["disabled"],Z=["disabled"],$={key:0},ss={key:1,class:"btn-loading-content"};function rs(e,r,a,os,o,l){const f=b("ProfileLayout");return n(),v(f,null,{default:M(()=>[s("div",x,[r[29]||(r[29]=s("div",{class:"page-header"},[s("h1",{class:"page-title"},"Change Password"),s("p",{class:"page-subtitle"},"Update your password to keep your account secure")],-1)),o.successMessage?(n(),i("div",L,[r[12]||(r[12]=s("svg",{class:"success-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),s("div",B,[s("p",N,u(o.successMessage),1),r[11]||(r[11]=s("p",{class:"alert-subtitle"},"A confirmation email has been sent to your email address",-1))])])):w("",!0),o.errorMessage?(n(),i("div",j,[r[13]||(r[13]=s("svg",{class:"error-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),s("p",q,u(o.errorMessage),1)])):w("",!0),s("form",{onSubmit:r[10]||(r[10]=y((...t)=>l.handleSubmit&&l.handleSubmit(...t),["prevent"])),class:"password-form"},[r[28]||(r[28]=s("div",{class:"security-notice"},[s("svg",{class:"notice-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})]),s("div",{class:"notice-content"},[s("p",{class:"notice-title"},"Security Tips"),s("ul",{class:"notice-list"},[s("li",null,"Use a strong, unique password"),s("li",null,"Don't reuse passwords from other sites"),s("li",null,"Consider using a password manager")])])],-1)),s("div",_,[r[16]||(r[16]=s("label",{for:"currentPassword",class:"form-label"},[c(" Current Password "),s("span",{class:"required"},"*")],-1)),s("div",z,[p(s("input",{id:"currentPassword","onUpdate:modelValue":r[0]||(r[0]=t=>o.form.oldPassword=t),type:o.showOldPassword?"text":"password",placeholder:"Enter your current password",class:d(["form-input pr-12",{"input-error":o.errors.oldPassword}]),disabled:o.isLoading,required:"",onInput:r[1]||(r[1]=t=>l.clearError("oldPassword"))},null,42,V),[[m,o.form.oldPassword]]),s("button",{type:"button",onClick:r[2]||(r[2]=t=>o.showOldPassword=!o.showOldPassword),class:"password-toggle",tabindex:"-1"},[o.showOldPassword?(n(),i("svg",A,[...r[14]||(r[14]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])])):(n(),i("svg",D,[...r[15]||(r[15]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])]))])]),o.errors.oldPassword?(n(),i("p",H,u(o.errors.oldPassword),1)):w("",!0)]),s("div",U,[r[23]||(r[23]=s("label",{for:"newPassword",class:"form-label"},[c(" New Password "),s("span",{class:"required"},"*")],-1)),s("div",E,[p(s("input",{id:"newPassword","onUpdate:modelValue":r[3]||(r[3]=t=>o.form.newPassword=t),type:o.showNewPassword?"text":"password",placeholder:"Enter your new password",class:d(["form-input pr-12",{"input-error":o.errors.newPassword}]),disabled:o.isLoading,required:"",onInput:r[4]||(r[4]=t=>l.clearError("newPassword"))},null,42,I),[[m,o.form.newPassword]]),s("button",{type:"button",onClick:r[5]||(r[5]=t=>o.showNewPassword=!o.showNewPassword),class:"password-toggle",tabindex:"-1"},[o.showNewPassword?(n(),i("svg",S,[...r[17]||(r[17]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])])):(n(),i("svg",F,[...r[18]||(r[18]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])]))])]),o.errors.newPassword?(n(),i("p",O,u(o.errors.newPassword),1)):w("",!0),s("div",T,[r[22]||(r[22]=s("p",{class:"requirements-title"},"New password must contain:",-1)),s("div",{class:d(["requirement-item",{met:l.passwordHasMinLength}])},[...r[19]||(r[19]=[s("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),s("span",null,"At least 8 characters",-1)])],2),s("div",{class:d(["requirement-item",{met:l.passwordHasNumber}])},[...r[20]||(r[20]=[s("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),s("span",null,"At least one number",-1)])],2),s("div",{class:d(["requirement-item",{met:l.passwordIsDifferent}])},[...r[21]||(r[21]=[s("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),s("span",null,"Different from current password",-1)])],2)])]),s("div",Y,[r[26]||(r[26]=s("label",{for:"confirmPassword",class:"form-label"},[c(" Confirm New Password "),s("span",{class:"required"},"*")],-1)),s("div",G,[p(s("input",{id:"confirmPassword","onUpdate:modelValue":r[6]||(r[6]=t=>o.form.confirmPassword=t),type:o.showConfirmPassword?"text":"password",placeholder:"Confirm your new password",class:d(["form-input pr-12",{"input-error":o.errors.confirmPassword}]),disabled:o.isLoading,required:"",onInput:r[7]||(r[7]=t=>l.clearError("confirmPassword"))},null,42,J),[[m,o.form.confirmPassword]]),s("button",{type:"button",onClick:r[8]||(r[8]=t=>o.showConfirmPassword=!o.showConfirmPassword),class:"password-toggle",tabindex:"-1"},[o.showConfirmPassword?(n(),i("svg",K,[...r[24]||(r[24]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])])):(n(),i("svg",Q,[...r[25]||(r[25]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])]))])]),o.errors.confirmPassword?(n(),i("p",R,u(o.errors.confirmPassword),1)):w("",!0)]),s("div",W,[s("button",{type:"button",onClick:r[9]||(r[9]=(...t)=>l.handleCancel&&l.handleCancel(...t)),class:"btn-secondary",disabled:o.isLoading}," Cancel ",8,X),s("button",{type:"submit",class:d(["btn-primary",{"btn-loading":o.isLoading}]),disabled:o.isLoading||!l.isFormValid},[o.isLoading?(n(),i("span",ss,[...r[27]||(r[27]=[s("svg",{class:"spinner",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4",fill:"none"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),s("span",null,"Changing...",-1)])])):(n(),i("span",$,"Change Password"))],10,Z)])],32)])]),_:1})}const ls=k(C,[["render",rs],["__scopeId","data-v-6d0409ca"]]);export{ls as default};
