import{A as C}from"./AuthLayout-C81FF4-c.js";import{r as f,b,v as M}from"./authService-Aa4usrHm.js";import{_ as S,s as L,w as h,g,o as i,b as e,c as n,d as u,F as x,r as _,n as a,t as d,e as N,x as w,C as c,y as v,D as m,A as k,a as V}from"./index-B8UE80VR.js";import"./Nita-logo-CbE_mBG5.js";const R={name:"ForgotPasswordView",components:{AuthLayout:C},data(){return{currentStep:1,steps:["Enter Email","Verify Code","New Password"],form:{email:"",code:"",newPassword:"",confirmPassword:""},errors:{},errorMessage:"",isLoading:!1,showSuccess:!1,showNewPassword:!1,showConfirmPassword:!1,resendCooldown:0}},computed:{passwordHasMinLength(){return this.form.newPassword.length>=8},passwordHasNumber(){return/\d/.test(this.form.newPassword)},isCurrentStepValid(){return this.currentStep===1?this.form.email&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.form.email):this.currentStep===2?this.form.code&&this.form.code.length===6:this.currentStep===3?this.form.newPassword&&this.form.confirmPassword&&this.passwordHasMinLength&&this.passwordHasNumber&&this.form.newPassword===this.form.confirmPassword:!1}},methods:{handleCodeInput(o){this.form.code=o.target.value.replace(/\D/g,""),this.clearError("code")},clearError(o){this.errors[o]&&(this.errors[o]=""),this.errorMessage&&(this.errorMessage="")},validateStep(){this.errors={};let o=!0;return this.currentStep===1?this.form.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.form.email)||(this.errors.email="Please enter a valid email address",o=!1):(this.errors.email="Email is required",o=!1):this.currentStep===2?this.form.code.trim()?this.form.code.length!==6&&(this.errors.code="Code must be 6 digits",o=!1):(this.errors.code="Verification code is required",o=!1):this.currentStep===3&&(this.form.newPassword?this.form.newPassword.length<8?(this.errors.newPassword="Password must be at least 8 characters",o=!1):/\d/.test(this.form.newPassword)||(this.errors.newPassword="Password must contain at least one number",o=!1):(this.errors.newPassword="Password is required",o=!1),this.form.confirmPassword?this.form.newPassword!==this.form.confirmPassword&&(this.errors.confirmPassword="Passwords do not match",o=!1):(this.errors.confirmPassword="Please confirm your password",o=!1)),o},async handleNext(){if(!this.validateStep()){window.scrollTo({top:0,behavior:"smooth"});return}this.currentStep===1?await this.sendResetCode():this.currentStep===2?await this.verifyCode():this.currentStep===3&&await this.resetUserPassword()},handlePrevious(){this.currentStep>1&&(this.currentStep--,this.errorMessage="")},async sendResetCode(){this.errorMessage="",this.isLoading=!0;try{await f(this.form.email.trim().toLowerCase()),this.currentStep=2,this.startResendCooldown()}catch(o){if(console.error("Send reset code error:",o),o.response){const{data:s}=o.response;this.errorMessage=s.message||"Failed to send verification code"}else this.errorMessage="Network error. Please try again."}finally{this.isLoading=!1}},async verifyCode(){this.errorMessage="",this.isLoading=!0;try{await M(this.form.email,this.form.code),this.currentStep=3}catch(o){if(console.error("Verify code error:",o),o.response){const{data:s}=o.response;s.expired?this.errorMessage="Code expired. Please request a new one.":this.errorMessage=s.message||"Invalid verification code"}else this.errorMessage="Network error. Please try again."}finally{this.isLoading=!1}},async resetUserPassword(){this.errorMessage="",this.isLoading=!0;try{await b(this.form.email,this.form.code,this.form.newPassword),this.showSuccess=!0,window.scrollTo({top:0,behavior:"smooth"})}catch(o){if(console.error("Reset password error:",o),o.response){const{data:s}=o.response;this.errorMessage=s.message||"Failed to reset password"}else this.errorMessage="Network error. Please try again.";window.scrollTo({top:0,behavior:"smooth"})}finally{this.isLoading=!1}},async resendCode(){this.errorMessage="",this.isLoading=!0;try{await f(this.form.email),this.errorMessage="",alert("New verification code sent! Check your email."),this.startResendCooldown()}catch(o){console.error("Resend code error:",o),this.errorMessage="Failed to resend code. Please try again."}finally{this.isLoading=!1}},startResendCooldown(){this.resendCooldown=60;const o=setInterval(()=>{this.resendCooldown--,this.resendCooldown<=0&&clearInterval(o)},1e3)},goToLogin(){this.$router.push("/login")}}},q={class:"forgot-password-wizard"},B={class:"progress-steps"},A={class:"step-circle"},E={key:0,class:"checkmark"},I={key:1},j={class:"step-label"},z={class:"form-header"},T={class:"form-subtitle"},F={key:0,class:"error-alert"},H={class:"error-text"},U={key:1,class:"success-card"},D={class:"form-step"},Y={class:"form-group"},G=["disabled"],W={key:0,class:"field-error"},J={class:"form-step"},K={class:"step-description"},O={class:"form-group"},Q=["disabled"],X={key:0,class:"field-error"},Z=["disabled"],$={class:"form-step"},ss={class:"form-group"},es={class:"password-wrapper"},rs=["type","disabled"],os={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ts={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},is={key:0,class:"field-error"},ns={class:"password-requirements"},ls={class:"form-group"},ds={class:"password-wrapper"},as=["type","disabled"],us={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ws={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},cs={key:0,class:"field-error"},ps={class:"form-navigation"},ms=["disabled"],fs=["disabled"],hs={key:0},gs={key:1,class:"btn-loading-content"},vs={key:3,class:"form-footer"},ks={class:"footer-text"};function Ps(o,s,ys,Cs,r,l){const P=g("router-link"),y=g("AuthLayout");return i(),L(y,null,{default:h(()=>[e("div",q,[e("div",B,[(i(!0),n(x,null,_(r.steps,(t,p)=>(i(),n("div",{key:p,class:a(["step-item",{active:r.currentStep===p+1,completed:r.currentStep>p+1}])},[e("div",A,[r.currentStep>p+1?(i(),n("span",E,"âœ“")):(i(),n("span",I,d(p+1),1))]),e("span",j,d(t),1)],2))),128))]),e("div",z,[s[14]||(s[14]=e("h2",{class:"form-title"},"Reset Password",-1)),e("p",T,"Step "+d(r.currentStep)+" of "+d(r.steps.length)+": "+d(r.steps[r.currentStep-1]),1)]),r.errorMessage?(i(),n("div",F,[s[15]||(s[15]=e("svg",{class:"error-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("p",H,d(r.errorMessage),1)])):u("",!0),r.showSuccess?(i(),n("div",U,[s[16]||(s[16]=e("div",{class:"success-icon-wrapper"},[e("svg",{class:"success-check",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),s[17]||(s[17]=e("h3",{class:"success-title"},"Password Reset Successfully!",-1)),s[18]||(s[18]=e("p",{class:"success-message"}," Your password has been changed. You can now login with your new password. ",-1)),e("button",{onClick:s[0]||(s[0]=(...t)=>l.goToLogin&&l.goToLogin(...t)),class:"login-btn"}," Go to Login ")])):(i(),n("form",{key:2,onSubmit:s[13]||(s[13]=N((...t)=>l.handleNext&&l.handleNext(...t),["prevent"])),class:"reset-form",novalidate:""},[w(e("div",D,[s[20]||(s[20]=e("p",{class:"step-description"}," Enter your email address and we'll send you a verification code to reset your password. ",-1)),e("div",Y,[s[19]||(s[19]=e("label",{for:"email",class:"form-label"},[c("Email Address "),e("span",{class:"required"},"*")],-1)),w(e("input",{id:"email","onUpdate:modelValue":s[1]||(s[1]=t=>r.form.email=t),type:"email",placeholder:"you@example.com",class:a(["form-input",{"input-error":r.errors.email}]),disabled:r.isLoading,onInput:s[2]||(s[2]=t=>l.clearError("email"))},null,42,G),[[v,r.form.email]]),r.errors.email?(i(),n("p",W,d(r.errors.email),1)):u("",!0)])],512),[[m,r.currentStep===1]]),w(e("div",J,[e("p",K,[s[21]||(s[21]=c(" We've sent a 6-digit verification code to ",-1)),e("strong",null,d(r.form.email),1)]),e("div",O,[s[22]||(s[22]=e("label",{for:"code",class:"form-label"},[c("Verification Code "),e("span",{class:"required"},"*")],-1)),w(e("input",{id:"code","onUpdate:modelValue":s[3]||(s[3]=t=>r.form.code=t),type:"text",inputmode:"numeric",pattern:"[0-9]{6}",placeholder:"000000",class:a(["form-input code-input",{"input-error":r.errors.code}]),disabled:r.isLoading,maxlength:"6",onInput:s[4]||(s[4]=(...t)=>l.handleCodeInput&&l.handleCodeInput(...t))},null,42,Q),[[v,r.form.code]]),r.errors.code?(i(),n("p",X,d(r.errors.code),1)):u("",!0),s[23]||(s[23]=e("p",{class:"field-hint"}," Check your email inbox for the verification code. It expires in 15 minutes. ",-1))]),e("button",{type:"button",onClick:s[5]||(s[5]=(...t)=>l.resendCode&&l.resendCode(...t)),class:"resend-link",disabled:r.isLoading||r.resendCooldown>0},d(r.resendCooldown>0?`Resend code in ${r.resendCooldown}s`:"Resend Code"),9,Z)],512),[[m,r.currentStep===2]]),w(e("div",$,[s[33]||(s[33]=e("p",{class:"step-description"}," Enter your new password. Make sure it's strong and unique. ",-1)),e("div",ss,[s[29]||(s[29]=e("label",{for:"newPassword",class:"form-label"},[c("New Password "),e("span",{class:"required"},"*")],-1)),e("div",es,[w(e("input",{id:"newPassword","onUpdate:modelValue":s[6]||(s[6]=t=>r.form.newPassword=t),type:r.showNewPassword?"text":"password",placeholder:"Create a strong password",class:a(["form-input pr-12",{"input-error":r.errors.newPassword}]),disabled:r.isLoading,onInput:s[7]||(s[7]=t=>l.clearError("newPassword"))},null,42,rs),[[k,r.form.newPassword]]),e("button",{type:"button",onClick:s[8]||(s[8]=t=>r.showNewPassword=!r.showNewPassword),class:"password-toggle",tabindex:"-1"},[r.showNewPassword?(i(),n("svg",os,[...s[24]||(s[24]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])])):(i(),n("svg",ts,[...s[25]||(s[25]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])]))])]),r.errors.newPassword?(i(),n("p",is,d(r.errors.newPassword),1)):u("",!0),e("div",ns,[s[28]||(s[28]=e("p",{class:"requirements-title"},"Password must contain:",-1)),e("div",{class:a(["requirement-item",{met:l.passwordHasMinLength}])},[...s[26]||(s[26]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),e("span",null,"At least 8 characters",-1)])],2),e("div",{class:a(["requirement-item",{met:l.passwordHasNumber}])},[...s[27]||(s[27]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),e("span",null,"At least one number",-1)])],2)])]),e("div",ls,[s[32]||(s[32]=e("label",{for:"confirmPassword",class:"form-label"},[c("Confirm Password "),e("span",{class:"required"},"*")],-1)),e("div",ds,[w(e("input",{id:"confirmPassword","onUpdate:modelValue":s[9]||(s[9]=t=>r.form.confirmPassword=t),type:r.showConfirmPassword?"text":"password",placeholder:"Confirm your password",class:a(["form-input pr-12",{"input-error":r.errors.confirmPassword}]),disabled:r.isLoading,onInput:s[10]||(s[10]=t=>l.clearError("confirmPassword"))},null,42,as),[[k,r.form.confirmPassword]]),e("button",{type:"button",onClick:s[11]||(s[11]=t=>r.showConfirmPassword=!r.showConfirmPassword),class:"password-toggle",tabindex:"-1"},[r.showConfirmPassword?(i(),n("svg",us,[...s[30]||(s[30]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])])):(i(),n("svg",ws,[...s[31]||(s[31]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])]))])]),r.errors.confirmPassword?(i(),n("p",cs,d(r.errors.confirmPassword),1)):u("",!0)])],512),[[m,r.currentStep===3]]),e("div",ps,[r.currentStep>1?(i(),n("button",{key:0,type:"button",onClick:s[12]||(s[12]=(...t)=>l.handlePrevious&&l.handlePrevious(...t)),class:"nav-btn secondary",disabled:r.isLoading}," Previous ",8,ms)):u("",!0),e("button",{type:"submit",class:a(["nav-btn primary",{"btn-loading":r.isLoading}]),disabled:r.isLoading||!l.isCurrentStepValid},[r.isLoading?(i(),n("span",gs,[...s[34]||(s[34]=[e("svg",{class:"spinner",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4",fill:"none"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),e("span",null,"Processing...",-1)])])):(i(),n("span",hs,d(r.currentStep===r.steps.length?"Reset Password":"Next"),1))],10,fs)])],32)),r.showSuccess?u("",!0):(i(),n("div",vs,[e("p",ks,[s[36]||(s[36]=c(" Remember your password? ",-1)),V(P,{to:"/login",class:"login-link"},{default:h(()=>[...s[35]||(s[35]=[c("Back to Login",-1)])]),_:1})])]))])]),_:1})}const xs=S(R,[["render",Ps],["__scopeId","data-v-6b0033c0"]]);export{xs as default};
